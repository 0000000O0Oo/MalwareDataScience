#Still working on it
import pefile, sys, optparse
def getfileName():
    fOptions = optparse.OptionParser()
    fOptions.add_option("-f", "--file", dest="filename", help="Enter the PE file you would like to scan.")
    (rOptions, arguments) = fOptions.parse_args()
    if not rOptions.filename:
        fOptions.error('\n[-] Usage : (python/python3) pefile.py -f "FILE"\n[-] Please specify a target, use --help for more infos.')
    return rOptions.filename


file = getfileName()
file.replace("\\\\", "\\")
pe = pefile.PE(file)
for section in pe.sections:
    print("[+] Section", (section.Name).decode("utf-8"), " : ",hex(section.VirtualAddress), hex(section.Misc_VirtualSize), section.SizeOfRawData)
for entry in pe.DIRECTORY_ENTRY_IMPORT:
    print("[+] Imported DLLs : ", (entry.dll).decode('utf-8'))
    for function in entry.imports:
        print("\t-", (function.name).decode("utf-8"))
