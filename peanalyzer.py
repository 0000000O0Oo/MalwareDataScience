import pefile, sys, optparse
def getfileName():
    fOptions = optparse.OptionParser()
    fOptions.add_option("-f", "--file", dest="filename", help="Enter the PE file you would like to scan.")
    (rOptions, arguments) = fOptions.parse_args()
    if not rOptions.filename:
        fOptions.error('\n[-] Usage : (python/python3) pefile.py -f "FILE"\n[-] Please specify a target, use --help for more infos.')
    return rOptions.filename

wfile = open("PE-Result.txt", "w")
afile = open("PE-Result.txt", "a")
file = getfileName()
file.replace("\\\\", "\\")
pe = pefile.PE(file)
for section in pe.sections:
    print("[+] Section", ((section.Name).decode("utf-8")), " : ",hex(section.VirtualAddress), hex(section.Misc_VirtualSize), section.SizeOfRawData)
    wfile.write("[+] Section " + (section.Name).decode("utf8") + " : " + hex(section.VirtualAddress) + " " + hex(section.Misc_VirtualSize) + " " + str(section.SizeOfRawData) + "\n")
for entry in pe.DIRECTORY_ENTRY_IMPORT:
    print("[+] Imported DLLs : ", (entry.dll).decode('utf-8'))
    afile.write("[+] Imported DLLs : " + (entry.dll).decode("utf-8") + "\n")
    for function in entry.imports:
        afile.write("\t- " + (function.name).decode("utf-8") + "\n")
        print("\t-", (function.name).decode("utf-8"))
